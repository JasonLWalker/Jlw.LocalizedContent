(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)})(function(n){"use strict";function p(n){for(var u=n.split(/\s+/),i=[],r=0,t;t=u[r];r++)t=t.charAt(0).toUpperCase(),i.push(t);return i}function s(t){return t.id&&n('label[for="'+t.id+'"]').val()||t.name}function v(t,i,r){return r||(r=0),i.each(function(){var i=n(this),f=this,o=this.nodeName.toLowerCase(),e,u;o==="label"&&i.find("input, textarea, select").length&&(e=i.text(),i=i.children().first(),f=i.get(0),o=f.nodeName.toLowerCase());switch(o){case"menu":u={name:i.attr("label"),items:{}};r=v(u.items,i.children(),r);break;case"a":case"button":u={name:i.text(),disabled:!!i.attr("disabled"),callback:function(){return function(){i.get(0).click()}}()};break;case"menuitem":case"command":switch(i.attr("type")){case undefined:case"command":case"menuitem":u={name:i.attr("label"),disabled:!!i.attr("disabled"),icon:i.attr("icon"),callback:function(){return function(){i.get(0).click()}}()};break;case"checkbox":u={type:"checkbox",disabled:!!i.attr("disabled"),name:i.attr("label"),selected:!!i.attr("checked")};break;case"radio":u={type:"radio",disabled:!!i.attr("disabled"),name:i.attr("label"),radio:i.attr("radiogroup"),value:i.attr("id"),selected:!!i.attr("checked")};break;default:u=undefined}break;case"hr":u="-------";break;case"input":switch(i.attr("type")){case"text":u={type:"text",name:e||s(f),disabled:!!i.attr("disabled"),value:i.val()};break;case"checkbox":u={type:"checkbox",name:e||s(f),disabled:!!i.attr("disabled"),selected:!!i.attr("checked")};break;case"radio":u={type:"radio",name:e||s(f),disabled:!!i.attr("disabled"),radio:!!i.attr("name"),value:i.val(),selected:!!i.attr("checked")};break;default:u=undefined}break;case"select":u={type:"select",name:e||s(f),disabled:!!i.attr("disabled"),selected:i.val(),options:{}};i.children().each(function(){u.options[this.value]=n(this).text()});break;case"textarea":u={type:"textarea",name:e||s(f),disabled:!!i.attr("disabled"),value:i.val()};break;case"label":break;default:u={type:"html",html:i.clone(!0)}}u&&(r++,t["key"+r]=u)}),r}n.support.htmlMenuitem="HTMLMenuItemElement"in window;n.support.htmlCommand="HTMLCommandElement"in window;n.support.eventSelectstart="onselectstart"in document.documentElement;n.ui&&n.widget||(n.cleanData=function(t){return function(i){for(var u,f,r=0;i[r]!=null;r++){f=i[r];try{u=n._data(f,"events");u&&u.remove&&n(f).triggerHandler("remove")}catch(e){}}t(i)}}(n.cleanData));var i=null,h=!1,e=n(window),c=0,o={},u={},l={},a={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(t){if(n.ui&&n.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight();i.left+=this.outerWidth()/2-t.outerWidth()/2;t.css(i)}},position:function(n,t,i){var r,u;if(t||i)t==="maintain"&&i==="maintain"?r=n.$menu.position():(u=n.$menu.offsetParent().offset(),r={top:i-u.top,left:t-u.left});else{n.determinePosition.call(this,n.$menu);return}var s=e.scrollTop()+e.height(),h=e.scrollLeft()+e.width(),f=n.$menu.outerHeight(),o=n.$menu.outerWidth();r.top+f>s&&(r.top-=f);r.top<0&&(r.top=0);r.left+o>h&&(r.left-=o);r.left<0&&(r.left=0);n.$menu.css(r)},positionSubmenu:function(t){if(typeof t!="undefined")if(n.ui&&n.ui.position)t.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:-9,left:this.outerWidth()-5};t.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{preShow:n.noop,show:n.noop,hide:n.noop,activated:n.noop},callback:null,items:{}},f={timer:null,pageX:null,pageY:null},y=function(n){for(var i=0,t=n;;)if(i=Math.max(i,parseInt(t.css("z-index"),10)||0),t=t.parent(),!t||!t.length||"html body".indexOf(t.prop("nodeName").toLowerCase())>-1)break;return i},t={abortevent:function(n){n.preventDefault();n.stopImmediatePropagation()},contextmenu:function(t){var u=n(this),f;if(t.data.events.preShow(u,t)!==!1&&(t.data.trigger==="right"&&(t.preventDefault(),t.stopImmediatePropagation()),t.data.trigger==="right"||t.data.trigger==="demand"||!t.originalEvent)&&(typeof t.mouseButton=="undefined"||!t.data||t.data.trigger==="left"&&t.mouseButton===0||t.data.trigger==="right"&&t.mouseButton===2)&&!u.hasClass("context-menu-active")&&!u.hasClass("context-menu-disabled")){if(i=u,t.data.build){if(f=t.data.build(i,t),f===!1)return;if(t.data=n.extend(!0,{},a,t.data,f||{}),!t.data.items||n.isEmptyObject(t.data.items)){window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu");throw new Error("No Items specified");}t.data.$trigger=i;r.create(t.data)}r.show.call(u,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault();t.stopImmediatePropagation();n(this).trigger(n.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var r=n(this);i&&i.length&&!i.is(r)&&i.data("contextMenu").$menu.trigger("contextmenu:hide");t.button===2&&(i=r.data("contextMenuActive",!0))},mouseup:function(t){var r=n(this);r.data("contextMenuActive")&&i&&i.length&&i.is(r)&&!r.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),i=r,r.trigger(n.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY})));r.removeData("contextMenuActive")},mouseenter:function(r){var u=n(this),e=n(r.relatedTarget),o=n(document);if(!e.is(".context-menu-list")&&!e.closest(".context-menu-list").length&&(!i||!i.length)){f.pageX=r.pageX;f.pageY=r.pageY;f.data=r.data;o.on("mousemove.contextMenuShow",t.mousemove);f.timer=setTimeout(function(){f.timer=null;o.off("mousemove.contextMenuShow");i=u;u.trigger(n.Event("contextmenu",{data:f.data,pageX:f.pageX,pageY:f.pageY}))},r.data.delay)}},mousemove:function(n){f.pageX=n.pageX;f.pageY=n.pageY},mouseleave:function(t){var i=n(t.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(f.timer)}catch(t){}f.timer=null}},layerClick:function(t){var h=n(this),i=h.data("contextMenuRoot"),s=t.button,f=t.pageX,o=t.pageY,c=f===undefined,u,r;t.preventDefault();setTimeout(function(){var a,h,l,v;if(c){i!==null&&typeof i!="undefined"&&i.$menu!==null&&typeof i.$menu!="undefined"&&i.$menu.trigger("contextmenu:hide");return}if(h=i.trigger==="left"&&s===0||i.trigger==="right"&&s===2,document.elementFromPoint&&i.$layer&&(i.$layer.hide(),u=document.elementFromPoint(f-e.scrollLeft(),o-e.scrollTop()),u!==null&&u.isContentEditable&&(l=document.createRange(),v=window.getSelection(),l.selectNode(u),l.collapse(!0),v.removeAllRanges(),v.addRange(l)),n(u).trigger(t),i.$layer.show()),i.hideOnSecondTrigger&&h&&i.$menu!==null&&typeof i.$menu!="undefined"){i.$menu.trigger("contextmenu:hide");return}if(i.reposition&&h)if(document.elementFromPoint){if(i.$trigger.is(u)){i.position.call(i.$trigger,i,f,o);return}}else if(r=i.$trigger.offset(),a=n(window),r.top+=a.scrollTop(),r.top<=t.pageY&&(r.left+=a.scrollLeft(),r.left<=t.pageX&&(r.bottom=r.top+i.$trigger.outerHeight(),r.bottom>=t.pageY&&(r.right=r.left+i.$trigger.outerWidth(),r.right>=t.pageX)))){i.position.call(i.$trigger,i,f,o);return}if(u&&h)i.$trigger.one("contextmenu:hidden",function(){n(u).contextMenu({x:f,y:o,button:s})});i!==null&&typeof i!="undefined"&&i.$menu!==null&&typeof i.$menu!="undefined"&&i.$menu.trigger("contextmenu:hide")},50)},keyStop:function(n,t){t.isInput||n.preventDefault();n.stopPropagation()},key:function(n){var r={},o,u,s,f,e;if(i&&(r=i.data("contextMenu")||{}),typeof r.zIndex=="undefined"&&(r.zIndex=0),o=0,u=function(n){n.style.zIndex!==""?o=n.style.zIndex:n.offsetParent!==null&&typeof n.offsetParent!="undefined"?u(n.offsetParent):n.parentElement!==null&&typeof n.parentElement!="undefined"&&u(n.parentElement)},u(n.target),!r.$menu||!(parseInt(o,10)>parseInt(r.$menu.css("zIndex"),10))){switch(n.keyCode){case 9:case 38:if(t.keyStop(n,r),r.isInput){if(n.keyCode===9&&n.shiftKey){n.preventDefault();r.$selected&&r.$selected.find("input, textarea, select").blur();r.$menu!==null&&typeof r.$menu!="undefined"&&r.$menu.trigger("prevcommand");return}if(n.keyCode===38&&r.$selected.find("input, textarea, select").prop("type")==="checkbox"){n.preventDefault();return}}else if(n.keyCode!==9||n.shiftKey){r.$menu!==null&&typeof r.$menu!="undefined"&&r.$menu.trigger("prevcommand");return}break;case 40:if(t.keyStop(n,r),r.isInput){if(n.keyCode===9){n.preventDefault();r.$selected&&r.$selected.find("input, textarea, select").blur();r.$menu!==null&&typeof r.$menu!="undefined"&&r.$menu.trigger("nextcommand");return}if(n.keyCode===40&&r.$selected.find("input, textarea, select").prop("type")==="checkbox"){n.preventDefault();return}}else{r.$menu!==null&&typeof r.$menu!="undefined"&&r.$menu.trigger("nextcommand");return}break;case 37:if(t.keyStop(n,r),r.isInput||!r.$selected||!r.$selected.length)break;if(!r.$selected.parent().hasClass("context-menu-root")){s=r.$selected.parent().parent();r.$selected.trigger("contextmenu:blur");r.$selected=s;return}break;case 39:if(t.keyStop(n,r),r.isInput||!r.$selected||!r.$selected.length)break;if(f=r.$selected.data("contextMenu")||{},f.$menu&&r.$selected.hasClass("context-menu-submenu")){r.$selected=null;f.$selected=null;f.$menu.trigger("nextcommand");return}break;case 35:case 36:if(r.$selected&&r.$selected.find("input, textarea, select").length)return;(r.$selected&&r.$selected.parent()||r.$menu).children(":not(."+r.classNames.disabled+", ."+r.classNames.notSelectable+")")[n.keyCode===36?"first":"last"]().trigger("contextmenu:focus");n.preventDefault();return;case 13:if(t.keyStop(n,r),r.isInput){if(r.$selected&&!r.$selected.is("textarea, select")){n.preventDefault();return}break}typeof r.$selected!="undefined"&&r.$selected!==null&&r.$selected.trigger("mouseup");return;case 32:case 33:case 34:t.keyStop(n,r);return;case 27:t.keyStop(n,r);r.$menu!==null&&typeof r.$menu!="undefined"&&r.$menu.trigger("contextmenu:hide");return;default:if(e=String.fromCharCode(n.keyCode).toUpperCase(),r.accesskeys&&r.accesskeys[e]){r.accesskeys[e].$node.trigger(r.accesskeys[e].$menu?"contextmenu:focus":"mouseup");return}}n.stopPropagation();typeof r.$selected!="undefined"&&r.$selected!==null&&r.$selected.trigger(n)}},prevItem:function(i){var r,f,o,e;i.stopPropagation();r=n(this).data("contextMenu")||{};f=n(this).data("contextMenuRoot")||{};r.$selected&&(o=r.$selected,r=r.$selected.parent().data("contextMenu")||{},r.$selected=o);for(var s=r.$menu.children(),u=!r.$selected||!r.$selected.prev().length?s.last():r.$selected.prev(),h=u;u.hasClass(f.classNames.disabled)||u.hasClass(f.classNames.notSelectable)||u.is(":hidden");)if(u=u.prev().length?u.prev():s.last(),u.is(h))return;r.$selected&&t.itemMouseleave.call(r.$selected.get(0),i);t.itemMouseenter.call(u.get(0),i);e=u.find("input, textarea, select");e.length&&e.focus()},nextItem:function(i){var r,f,o,e;i.stopPropagation();r=n(this).data("contextMenu")||{};f=n(this).data("contextMenuRoot")||{};r.$selected&&(o=r.$selected,r=r.$selected.parent().data("contextMenu")||{},r.$selected=o);for(var s=r.$menu.children(),u=!r.$selected||!r.$selected.next().length?s.first():r.$selected.next(),h=u;u.hasClass(f.classNames.disabled)||u.hasClass(f.classNames.notSelectable)||u.is(":hidden");)if(u=u.next().length?u.next():s.first(),u.is(h))return;r.$selected&&t.itemMouseleave.call(r.$selected.get(0),i);t.itemMouseenter.call(u.get(0),i);e=u.find("input, textarea, select");e.length&&e.focus()},focusInput:function(){var t=n(this).closest(".context-menu-item"),i=t.data(),r=i.contextMenu,u=i.contextMenuRoot;u.$selected=r.$selected=t;u.isInput=r.isInput=!0},blurInput:function(){var i=n(this).closest(".context-menu-item"),t=i.data(),r=t.contextMenu,u=t.contextMenuRoot;u.isInput=r.isInput=!1},menuMouseenter:function(){var t=n(this).data().contextMenuRoot;t.hovering=!0},menuMouseleave:function(t){var i=n(this).data().contextMenuRoot;i.$layer&&i.$layer.is(t.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(t){var r=n(this),f=r.data(),u=f.contextMenu,i=f.contextMenuRoot;if(i.hovering=!0,t&&i.$layer&&i.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(u.$menu?u:i).$menu.children("."+i.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),r.hasClass(i.classNames.disabled)||r.hasClass(i.classNames.notSelectable)){u.$selected=null;return}r.trigger("contextmenu:focus")},itemMouseleave:function(t){var u=n(this),f=u.data(),r=f.contextMenu,i=f.contextMenuRoot;if(i!==r&&i.$layer&&i.$layer.is(t.relatedTarget)){typeof i.$selected!="undefined"&&i.$selected!==null&&i.$selected.trigger("contextmenu:blur");t.preventDefault();t.stopImmediatePropagation();i.$selected=r.$selected=r.$node;return}r&&r.$menu&&r.$menu.hasClass("context-menu-visible")||u.trigger("contextmenu:blur")},itemClick:function(t){var e=n(this),o=e.data(),f=o.contextMenu,i=o.contextMenuRoot,u=o.contextMenuKey,s;if(f.items[u]&&!e.is("."+i.classNames.disabled+", .context-menu-separator, ."+i.classNames.notSelectable)&&(!e.is(".context-menu-submenu")||i.selectableSubMenu!==!1)){if(t.preventDefault(),t.stopImmediatePropagation(),n.isFunction(f.callbacks[u])&&Object.prototype.hasOwnProperty.call(f.callbacks,u))s=f.callbacks[u];else if(n.isFunction(i.callback))s=i.callback;else return;s.call(i.$trigger,u,i,t)!==!1?i.$menu.trigger("contextmenu:hide"):i.$menu.parent().length&&r.update.call(i.$trigger,i)}},inputClick:function(n){n.stopImmediatePropagation()},hideMenu:function(t,i){var u=n(this).data("contextMenuRoot");r.hide.call(u.$trigger,u,i&&i.force)},focusItem:function(t){t.stopPropagation();var u=n(this),f=u.data(),r=f.contextMenu,i=f.contextMenuRoot;u.hasClass(i.classNames.disabled)||u.hasClass(i.classNames.notSelectable)||(u.addClass([i.classNames.hover,i.classNames.visible].join(" ")).parent().find(".context-menu-item").not(u).removeClass(i.classNames.visible).filter("."+i.classNames.hover).trigger("contextmenu:blur"),r.$selected=i.$selected=u,r&&r.$node&&r.$node.hasClass("context-menu-submenu")&&r.$node.addClass(i.classNames.hover),r.$node&&i.positionSubmenu.call(r.$node,r.$menu))},blurItem:function(t){t.stopPropagation();var i=n(this),r=i.data(),u=r.contextMenu,f=r.contextMenuRoot;u.autoHide&&i.removeClass(f.classNames.visible);i.removeClass(f.classNames.hover);u.$selected=null}},r={show:function(u,f,e){var o=n(this),s={},c,h;if(n("#context-menu-layer").trigger("mousedown"),u.$trigger=o,u.events.show.call(o,u)===!1){i=null;return}if(c=r.update.call(o,u),c===!1){i=null;return}u.position.call(o,u,f,e);u.zIndex&&(h=u.zIndex,typeof u.zIndex=="function"&&(h=u.zIndex.call(o,u)),s.zIndex=y(o)+h);r.layer.call(u.$menu,u,s.zIndex);u.$menu.find("ul").css("zIndex",s.zIndex+1);u.$menu.css(s)[u.animation.show](u.animation.duration,function(){o.trigger("contextmenu:visible");r.activated(u);u.events.activated(u)});o.data("contextMenu",u).addClass("context-menu-active");n(document).off("keydown.contextMenu").on("keydown.contextMenu",t.key);if(u.autoHide)n(document).on("mousemove.contextMenuAutoHide",function(n){var t=o.offset();t.right=t.left+o.outerWidth();t.bottom=t.top+o.outerHeight();!u.$layer||u.hovering||n.pageX>=t.left&&n.pageX<=t.right&&n.pageY>=t.top&&n.pageY<=t.bottom||setTimeout(function(){u.hovering||u.$menu===null||typeof u.$menu=="undefined"||u.$menu.trigger("contextmenu:hide")},50)})},hide:function(t,r){var u=n(this);if(t||(t=u.data("contextMenu")||{}),r||!t.events||t.events.hide.call(u,t)!==!1){if(u.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout(function(n){return function(){n.remove()}}(t.$layer),10);try{delete t.$layer}catch(f){t.$layer=null}}i=null;t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur");t.$selected=null;t.$menu.find("."+t.classNames.visible).removeClass(t.classNames.visible);n(document).off(".contextMenuAutoHide").off("keydown.contextMenu");t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),n.each(t,function(n){switch(n){case"ns":case"selector":case"build":case"trigger":return!0;default:t[n]=undefined;try{delete t[n]}catch(i){}return!0}}));setTimeout(function(){u.trigger("contextmenu:hidden")},10)})}},create:function(i,u){function f(t){var i=n("<span><\/span>");if(t._accesskey)t._beforeAccesskey&&i.append(document.createTextNode(t._beforeAccesskey)),n("<span><\/span>").addClass("context-menu-accesskey").text(t._accesskey).appendTo(i),t._afterAccesskey&&i.append(document.createTextNode(t._afterAccesskey));else if(t.isHtmlName){if(typeof t.accesskey!="undefined")throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");i.html(t.name)}else i.text(t.name);return i}typeof u=="undefined"&&(u=i);i.$menu=n('<ul class="context-menu-list"><\/ul>').addClass(i.className||"").data({contextMenu:i,contextMenuRoot:u});i.dataAttr&&n.each(i.dataAttr,function(n,t){i.$menu.attr("data-"+i.key,t)});n.each(["callbacks","commands","inputs"],function(n,t){i[t]={};u[t]||(u[t]={})});u.accesskeys||(u.accesskeys={});n.each(i.items,function(e,o){var s=n('<li class="context-menu-item"><\/li>').addClass(o.className||""),c=null,h=null,w,y,v,a;s.on("click",n.noop);if((typeof o=="string"||o.type==="cm_separator")&&(o={type:"cm_seperator"}),o.$node=s.data({contextMenu:i,contextMenuRoot:u,contextMenuKey:e}),typeof o.accesskey!="undefined")for(w=p(o.accesskey),y=0;v=w[y];y++)if(!u.accesskeys[v]){u.accesskeys[v]=o;a=o.name.match(new RegExp("^(.*?)("+v+")(.*)$","i"));a&&(o._beforeAccesskey=a[1],o._accesskey=a[2],o._afterAccesskey=a[3]);break}if(o.type&&l[o.type])l[o.type].call(s,o,i,u),n.each([i,u],function(t,r){r.commands[e]=o;n.isFunction(o.callback)&&(typeof r.callbacks[e]=="undefined"||typeof i.type=="undefined")&&(r.callbacks[e]=o.callback)});else{o.type==="cm_seperator"?s.addClass("context-menu-separator "+u.classNames.notSelectable):o.type==="html"?s.addClass("context-menu-html "+u.classNames.notSelectable):o.type!=="sub"&&o.type?(c=n("<label><\/label>").appendTo(s),f(o).appendTo(c),s.addClass("context-menu-input"),i.hasTypes=!0,n.each([i,u],function(n,t){t.commands[e]=o;t.inputs[e]=o})):o.items&&(o.type="sub");switch(o.type){case"cm_seperator":break;case"text":h=n('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+e).val(o.value||"").appendTo(c);break;case"textarea":h=n('<textarea name=""><\/textarea>').attr("name","context-menu-input-"+e).val(o.value||"").appendTo(c);o.height&&h.height(o.height);break;case"checkbox":h=n('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+e).val(o.value||"").prop("checked",!!o.selected).prependTo(c);break;case"radio":h=n('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+o.radio).val(o.value||"").prop("checked",!!o.selected).prependTo(c);break;case"select":h=n('<select name=""><\/select>').attr("name","context-menu-input-"+e).appendTo(c);o.options&&(n.each(o.options,function(t,i){n("<option><\/option>").val(t).text(i).appendTo(h)}),h.val(o.selected));break;case"sub":f(o).appendTo(s);o.appendTo=o.$node;s.data("contextMenu",o).addClass("context-menu-submenu");o.callback=null;"function"==typeof o.items.then?r.processPromises(o,u,o.items):r.create(o,u);break;case"html":n(o.html).appendTo(s);break;default:n.each([i,u],function(t,r){r.commands[e]=o;n.isFunction(o.callback)&&(typeof r.callbacks[e]=="undefined"||typeof i.type=="undefined")&&(r.callbacks[e]=o.callback)});f(o).appendTo(s)}if(o.type&&o.type!=="sub"&&o.type!=="html"&&o.type!=="cm_seperator"){h.on("focus",t.focusInput).on("blur",t.blurInput);if(o.events)h.on(o.events,i)}o.icon&&(n.isFunction(o.icon)?o._icon=o.icon.call(this,this,s,e,o):typeof o.icon=="string"&&(o.icon.substring(0,4)==="fab "||o.icon.substring(0,4)==="fas "||o.icon.substring(0,4)==="fad "||o.icon.substring(0,4)==="far "||o.icon.substring(0,4)==="fal ")?(s.addClass(u.classNames.icon+" "+u.classNames.icon+"--fa5"),o._icon=n('<i class="'+o.icon+'"><\/i>')):o._icon=typeof o.icon=="string"&&o.icon.substring(0,3)==="fa-"?u.classNames.icon+" "+u.classNames.icon+"--fa fa "+o.icon:u.classNames.icon+" "+u.classNames.icon+"-"+o.icon,typeof o._icon=="string"?s.addClass(o._icon):s.prepend(o._icon))}if(o.$input=h,o.$label=c,s.appendTo(i.$menu),!i.hasTypes&&n.support.eventSelectstart)s.on("selectstart.disableTextSelect",t.abortevent)});i.$node||i.$menu.css("display","none").addClass("context-menu-root");i.$menu.appendTo(i.appendTo||document.body)},resize:function(t,i){var u;t.css({position:"absolute",display:"block"});t.data("width",(u=t.get(0)).getBoundingClientRect?Math.ceil(u.getBoundingClientRect().width):t.outerWidth()+1);t.css({position:"static",minWidth:"0px",maxWidth:"100000px"});t.find("> li > ul").each(function(){r.resize(n(this),!0)});i||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return n(this).data("width")})},update:function(t,i){var u=this,f;return typeof i=="undefined"&&(i=t,r.resize(t.$menu)),f=!1,t.$menu.children().each(function(){var o=n(this),s=o.data("contextMenuKey"),e=t.items[s],l=n.isFunction(e.disabled)&&e.disabled.call(u,s,i)||e.disabled===!0,c,h,a;if(c=n.isFunction(e.visible)?e.visible.call(u,s,i):typeof e.visible!="undefined"?e.visible===!0:!0,c&&(f=!0),o[c?"show":"hide"](),o[l?"addClass":"removeClass"](i.classNames.disabled),n.isFunction(e.icon)&&(o.removeClass(e._icon),h=e.icon.call(this,u,o,s,e),typeof h=="string"?o.addClass(h):o.prepend(h)),e.type){o.find("input, select, textarea").prop("disabled",l);switch(e.type){case"text":case"textarea":e.$input.val(e.value||"");break;case"checkbox":case"radio":e.$input.val(e.value||"").prop("checked",!!e.selected);break;case"select":e.$input.val((e.selected===0?"0":e.selected)||"")}}e.$menu&&(a=r.update.call(u,e,i),a&&(f=!0))}),f},layer:function(i,r){var u=i.$layer=n('<div id="context-menu-layer"><\/div>').css({height:e.height(),width:e.width(),display:"block",position:"fixed","z-index":r-1,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",i).appendTo(document.body).on("contextmenu",t.abortevent).on("mousedown",t.layerClick);return typeof document.body.style.maxWidth=="undefined"&&u.css({position:"absolute",height:n(document).height()}),u},processPromises:function(n,t,i){function e(n,t,i){typeof i=="undefined"&&u(undefined);f(n,t,i)}function u(n,t,i){typeof i=="undefined"?(i={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):typeof i=="string"&&(i={error:{name:i}});f(n,t,i)}function f(n,t,i){typeof t.$menu!="undefined"&&t.$menu.is(":visible")&&(n.$node.removeClass(t.classNames.iconLoadingClass),n.items=i,r.create(n,t,!0),r.update(n,t),t.positionSubmenu.call(n.$node,n.$menu))}n.$node.addClass(t.classNames.iconLoadingClass);i.then(e.bind(this,n,t),u.bind(this,n,t))},activated:function(t){var i=t.$menu,f=i.offset(),u=n(window).height(),r=n(window).scrollTop(),e=i.height();e>u?i.css({height:u+"px","overflow-x":"hidden","overflow-y":"auto",top:r+"px"}):(f.top<r||f.top+e>r+u)&&i.css({top:r+"px"})}};n.fn.contextMenu=function(i){var e=this,r=i,f;return this.length>0?typeof i=="undefined"?this.first().trigger("contextmenu"):typeof i.x!="undefined"&&typeof i.y!="undefined"?this.first().trigger(n.Event("contextmenu",{pageX:i.x,pageY:i.y,mouseButton:i.button})):i==="hide"?(f=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null,f&&f.trigger("contextmenu:hide")):i==="destroy"?n.contextMenu("destroy",{context:this}):n.isPlainObject(i)?(i.context=this,n.contextMenu("create",i)):i?this.removeClass("context-menu-disabled"):i||this.addClass("context-menu-disabled"):(n.each(u,function(){this.selector===e.selector&&(r.data=this,n.extend(r.data,{trigger:"demand"}))}),t.contextmenu.call(r.target,r)),this};n.contextMenu=function(i,f){var p,b,w,l,k;typeof i!="string"&&(f=i,i="create");typeof f=="string"?f={selector:f}:typeof f=="undefined"&&(f={});var e=n.extend(!0,{},a,f||{}),y=n(document),s=y,v=!1;e.context&&e.context.length?(s=n(e.context).first(),e.context=s.get(0),v=!n(e.context).is(document)):e.context=document;switch(i){case"update":if(v)r.update(s);else for(p in u)u.hasOwnProperty(p)&&r.update(u[p]);break;case"create":if(!e.selector)throw new Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||n.isEmptyObject(e.items)))throw new Error("No Items specified");if(c++,e.ns=".contextMenu"+c,v||(o[e.selector]=e.ns),u[e.ns]=e,e.trigger||(e.trigger="right"),!h){b=e.itemClickEvent==="click"?"click.contextMenu":"mouseup.contextMenu";w={"contextmenu:focus.contextMenu":t.focusItem,"contextmenu:blur.contextMenu":t.blurItem,"contextmenu.contextMenu":t.abortevent,"mouseenter.contextMenu":t.itemMouseenter,"mouseleave.contextMenu":t.itemMouseleave};w[b]=t.itemClick;y.on({"contextmenu:hide.contextMenu":t.hideMenu,"prevcommand.contextMenu":t.prevItem,"nextcommand.contextMenu":t.nextItem,"contextmenu.contextMenu":t.abortevent,"mouseenter.contextMenu":t.menuMouseenter,"mouseleave.contextMenu":t.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",t.inputClick).on(w,".context-menu-item");h=!0}s.on("contextmenu"+e.ns,e.selector,e,t.contextmenu);if(v)s.on("remove"+e.ns,function(){n(this).contextMenu("destroy")});switch(e.trigger){case"hover":s.on("mouseenter"+e.ns,e.selector,e,t.mouseenter).on("mouseleave"+e.ns,e.selector,e,t.mouseleave);break;case"left":s.on("click"+e.ns,e.selector,e,t.click);break;case"touchstart":s.on("touchstart"+e.ns,e.selector,e,t.click)}e.build||r.create(e);break;case"destroy":if(v)k=e.context,n.each(u,function(t,i){if(!i||!n(k).is(i.selector))return!0;l=n(".context-menu-list").filter(":visible");l.length&&l.data().contextMenuRoot.$trigger.is(n(i.context).find(i.selector))&&l.trigger("contextmenu:hide",{force:!0});try{u[i.ns].$menu&&u[i.ns].$menu.remove();delete u[i.ns]}catch(r){u[i.ns]=null}return n(i.context).off(i.ns),!0});else if(e.selector){if(o[e.selector]){l=n(".context-menu-list").filter(":visible");l.length&&l.data().contextMenuRoot.$trigger.is(e.selector)&&l.trigger("contextmenu:hide",{force:!0});try{u[o[e.selector]].$menu&&u[o[e.selector]].$menu.remove();delete u[o[e.selector]]}catch(d){u[o[e.selector]]=null}y.off(o[e.selector])}}else y.off(".contextMenu .contextMenuAutoHide"),n.each(u,function(t,i){n(i.context).off(i.ns)}),o={},u={},c=0,h=!1,n("#context-menu-layer, .context-menu-list").remove();break;case"html5":(n.support.htmlCommand||n.support.htmlMenuitem)&&(typeof f!="boolean"||!f)||n('menu[type="context"]').each(function(){this.id&&n.contextMenu({selector:"[contextmenu="+this.id+"]",items:n.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+i+'"');}return this};n.contextMenu.setInputValues=function(t,i){typeof i=="undefined"&&(i={});n.each(t.inputs,function(n,t){switch(t.type){case"text":case"textarea":t.value=i[n]||"";break;case"checkbox":t.selected=i[n]?!0:!1;break;case"radio":t.selected=(i[t.radio]||"")===t.value;break;case"select":t.selected=i[n]||""}})};n.contextMenu.getInputValues=function(t,i){return typeof i=="undefined"&&(i={}),n.each(t.inputs,function(n,t){switch(t.type){case"text":case"textarea":case"select":i[n]=t.$input.val();break;case"checkbox":i[n]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(i[t.radio]=t.value)}}),i};n.contextMenu.fromMenu=function(t){var r=n(t),i={};return v(i,r.children()),i};n.contextMenu.defaults=a;n.contextMenu.types=l;n.contextMenu.handle=t;n.contextMenu.op=r;n.contextMenu.menus=u});
/*! jQuery UI - v1.12.1 - 2016-09-16
 * http://jqueryui.com
 * Includes: position.js
 * Copyright jQuery Foundation and other contributors; Licensed MIT */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){var t,i;n.ui=n.ui||{};t=n.ui.version="1.12.1";
/*!
     * jQuery UI Position 1.12.1
     * http://jqueryui.com
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     *
     * http://api.jqueryui.com/position/
     */
(function(){function c(n,t,i){return[parseFloat(n[0])*(h.test(n[0])?t/100:1),parseFloat(n[1])*(h.test(n[1])?i/100:1)]}function r(t,i){return parseInt(n.css(t,i),10)||0}function a(t){var i=t[0];return i.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:n.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}var u,i=Math.max,t=Math.abs,f=/left|center|right/,e=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,h=/%$/,l=n.fn.position;n.position={scrollbarWidth:function(){if(u!==undefined)return u;var r,i,t=n("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'><\/div><\/div>"),f=t.children()[0];return n("body").append(t),r=f.offsetWidth,t.css("overflow","scroll"),i=f.offsetWidth,r===i&&(i=t[0].clientWidth),t.remove(),u=r-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),u=i==="scroll"||i==="auto"&&t.width<t.element[0].scrollWidth,f=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:f?n.position.scrollbarWidth():0,height:u?n.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=n(t||window),r=n.isWindow(i[0]),u=!!i[0]&&i[0].nodeType===9,f=!r&&!u;return{element:i,isWindow:r,isDocument:u,offset:f?n(t).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}};n.fn.position=function(u){if(!u||!u.of)return l.apply(this,arguments);u=n.extend({},u);var w,h,v,p,y,k,d=n(u.of),nt=n.position.getWithinInfo(u.within),tt=n.position.getScrollInfo(nt),b=(u.collision||"flip").split(" "),g={};return k=a(d),d[0].preventDefault&&(u.at="left top"),h=k.width,v=k.height,p=k.offset,y=n.extend({},p),n.each(["my","at"],function(){var n=(u[this]||"").split(" "),t,i;n.length===1&&(n=f.test(n[0])?n.concat(["center"]):e.test(n[0])?["center"].concat(n):["center","center"]);n[0]=f.test(n[0])?n[0]:"center";n[1]=e.test(n[1])?n[1]:"center";t=o.exec(n[0]);i=o.exec(n[1]);g[this]=[t?t[0]:0,i?i[0]:0];u[this]=[s.exec(n[0])[0],s.exec(n[1])[0]]}),b.length===1&&(b[1]=b[0]),u.at[0]==="right"?y.left+=h:u.at[0]==="center"&&(y.left+=h/2),u.at[1]==="bottom"?y.top+=v:u.at[1]==="center"&&(y.top+=v/2),w=c(g.at,h,v),y.left+=w[0],y.top+=w[1],this.each(function(){var a,k,e=n(this),o=e.outerWidth(),s=e.outerHeight(),it=r(this,"marginLeft"),rt=r(this,"marginTop"),ut=o+it+r(this,"marginRight")+tt.width,ft=s+rt+r(this,"marginBottom")+tt.height,f=n.extend({},y),l=c(g.my,e.outerWidth(),e.outerHeight());u.my[0]==="right"?f.left-=o:u.my[0]==="center"&&(f.left-=o/2);u.my[1]==="bottom"?f.top-=s:u.my[1]==="center"&&(f.top-=s/2);f.left+=l[0];f.top+=l[1];a={marginLeft:it,marginTop:rt};n.each(["left","top"],function(t,i){n.ui.position[b[t]]&&n.ui.position[b[t]][i](f,{targetWidth:h,targetHeight:v,elemWidth:o,elemHeight:s,collisionPosition:a,collisionWidth:ut,collisionHeight:ft,offset:[w[0]+l[0],w[1]+l[1]],my:u.my,at:u.at,within:nt,elem:e})});u.using&&(k=function(n){var r=p.left-f.left,a=r+h-o,c=p.top-f.top,y=c+v-s,l={target:{element:d,left:p.left,top:p.top,width:h,height:v},element:{element:e,left:f.left,top:f.top,width:o,height:s},horizontal:a<0?"left":r>0?"right":"center",vertical:y<0?"top":c>0?"bottom":"middle"};h<o&&t(r+a)<h&&(l.horizontal="center");v<s&&t(c+y)<v&&(l.vertical="middle");l.important=i(t(r),t(a))>i(t(c),t(y))?"horizontal":"vertical";u.using.call(this,n,l)});e.offset(n.extend(f,{using:k}))})};n.ui.position={fit:{left:function(n,t){var e=t.within,u=e.isWindow?e.scrollLeft:e.offset.left,o=e.width,s=n.left-t.collisionPosition.marginLeft,r=u-s,f=s+t.collisionWidth-o-u,h;t.collisionWidth>o?r>0&&f<=0?(h=n.left+r+t.collisionWidth-o-u,n.left+=r-h):n.left=f>0&&r<=0?u:r>f?u+o-t.collisionWidth:u:r>0?n.left+=r:f>0?n.left-=f:n.left=i(n.left-s,n.left)},top:function(n,t){var o=t.within,u=o.isWindow?o.scrollTop:o.offset.top,e=t.within.height,s=n.top-t.collisionPosition.marginTop,r=u-s,f=s+t.collisionHeight-e-u,h;t.collisionHeight>e?r>0&&f<=0?(h=n.top+r+t.collisionHeight-e-u,n.top+=r-h):n.top=f>0&&r<=0?u:r>f?u+e-t.collisionHeight:u:r>0?n.top+=r:f>0?n.top-=f:n.top=i(n.top-s,n.top)}},flip:{left:function(n,i){var r=i.within,y=r.offset.left+r.scrollLeft,c=r.width,o=r.isWindow?r.scrollLeft:r.offset.left,l=n.left-i.collisionPosition.marginLeft,a=l-o,v=l+i.collisionWidth-c-o,u=i.my[0]==="left"?-i.elemWidth:i.my[0]==="right"?i.elemWidth:0,f=i.at[0]==="left"?i.targetWidth:i.at[0]==="right"?-i.targetWidth:0,e=-2*i.offset[0],s,h;a<0?(s=n.left+u+f+e+i.collisionWidth-c-y,(s<0||s<t(a))&&(n.left+=u+f+e)):v>0&&(h=n.left-i.collisionPosition.marginLeft+u+f+e-o,(h>0||t(h)<v)&&(n.left+=u+f+e))},top:function(n,i){var r=i.within,y=r.offset.top+r.scrollTop,c=r.height,o=r.isWindow?r.scrollTop:r.offset.top,l=n.top-i.collisionPosition.marginTop,a=l-o,v=l+i.collisionHeight-c-o,p=i.my[1]==="top",u=p?-i.elemHeight:i.my[1]==="bottom"?i.elemHeight:0,f=i.at[1]==="top"?i.targetHeight:i.at[1]==="bottom"?-i.targetHeight:0,e=-2*i.offset[1],s,h;a<0?(h=n.top+u+f+e+i.collisionHeight-c-y,(h<0||h<t(a))&&(n.top+=u+f+e)):v>0&&(s=n.top-i.collisionPosition.marginTop+u+f+e-o,(s>0||t(s)<v)&&(n.top+=u+f+e))}},flipfit:{left:function(){n.ui.position.flip.left.apply(this,arguments);n.ui.position.fit.left.apply(this,arguments)},top:function(){n.ui.position.flip.top.apply(this,arguments);n.ui.position.fit.top.apply(this,arguments)}}}})();i=n.ui.position});
//# sourceMappingURL=jquery.contextmenu.min.js.map