/*!
 * jquery.dad.js v2 (http://konsolestudio.com/dad)
 * Author William Lima
 */
(function(n){"use strict";function u(){this.positionX=0;this.positionY=0;this.offsetX=0;this.offsetY=0}function t(t,i){this.options=this.parseOptions(i);this.$container=n(t);this.$current=null;this.$target=null;this.$clone=null;this.mouse=new u;this.holding=!1;this.dragging=!1;this.dropzones=[];this.setActive(this.options.active);this.setup()}var i={},r;i.supportsTouch="ontouchstart"in window||navigator.msMaxTouchPoints;i.shouldScroll=!0;i.supportsTouch&&(r=function(n){i.shouldScroll||n.preventDefault()},document.addEventListener("touchmove",r,{passive:!1}));u.prototype.update=function(t){if(i.supportsTouch&&t.type=="touchmove"){var r=t.originalEvent.touches[0],u=document.elementFromPoint(r.clientX,r.clientY);n(u).trigger("touchenter");this.positionX=r.pageX;this.positionY=r.pageY}else this.positionX=t.pageX,this.positionY=t.pageY};t.defaultOptions={active:!0,draggable:!1,exchangeable:!0,placeholderTarget:!1,placeholderTemplate:"<div />",placeholderClass:"dad-placeholder",targetClass:"dad-target",cloneClass:"dad-clone",transition:200};t.prototype.parseOptions=function(i){var r=n.extend(!0,{},t.defaultOptions);return i&&n.each(r,function(t){var u=i[t];typeof u!="undefined"&&(r[t]=typeof u=="object"?n.extend(r[t],u):u)}),r};t.prototype.setup=function(){function i(i){var r=n(this);t.prepare(i,r)}function r(i){if(t.$current){var r=n(this),u=!!t.$current.find(this).length,f=t.options.exchangeable,e=t.dragging&&(u||f);e&&t.updatePlaceholder(i,r)}}var t=this;this.$container.css({position:"relative","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"});this.$container.find("img").attr("ondragstart","return false");this.$container.on("mouseenter touchenter",function(i){if(t.$current){var r=n(this),u=!r.is(t.$current),f=t.options.exchangeable,e=t.dragging&&u&&f;e&&t.updatePlaceholder(i,r,!0)}});this.$container.on("mousedown touchstart","> *",i);this.$container.on("mouseenter touchenter","> *",r);n("body").on("mousemove touchmove",this.update.bind(this));n("body").on("mouseup touchend",this.end.bind(this));n("body").on("mouseleave",this.end.bind(this));n(window).on("blur",this.end.bind(this))};t.prototype.prepare=function(t,i){var u=this.options.draggable,r=u&&n(u),f=this.active&&(r?r.is(t.target)||r.find(t.target).length:!0);f&&(this.holding=!0,this.$target=i,this.$current=i.closest(this.$container),this.mouse.update(t))};t.prototype.start=function(){var r=this.options,t=this.$target,e=this.$current,u=t.clone().css({position:"absolute",zIndex:9999,pointerEvents:"none",height:t.outerHeight(),width:t.outerWidth()}),f=n(r.placeholderTemplate).css({position:"absolute",pointerEvents:"none",zIndex:9998,margin:0,padding:0,height:t.outerHeight(),width:t.outerWidth()});this.mouse.offsetX=this.mouse.positionX-t.offset().left;this.mouse.offsetY=this.mouse.positionY-t.offset().top;t.css("visibility","hidden");t.addClass(r.targetClass);u.addClass(r.cloneClass);f.addClass(r.placeholderClass);i.supportsTouch&&(i.shouldScroll=!1);this.dragging=!0;this.$target=t;this.$clone=u;this.$placeholder=f;e.append(f).append(u);this.updateClonePosition();this.updatePlaceholderPosition();n(e).trigger("dadDragStart",[t[0]])};t.prototype.update=function(n){this.mouse.update(n);this.holding&&!this.dragging&&this.start(n);this.dragging&&this.updateClonePosition()};t.prototype.end=function(){if(this.holding=!1,this.dragging){i.supportsTouch&&(i.shouldScroll=!0);var f=this.options,r=this.$current,t=this.$target,u=this.$clone,e=this.$placeholder,o=t.offset().left-this.getContainerX(),s=t.offset().top-this.getContainerY();n(r).trigger("dadDragEnd",[t[0]]);u.animate({top:s,left:o,height:t.outerHeight(),width:t.outerWidth()},this.options.transition,function(){u.remove();e.remove();t.removeClass(f.targetClass);t.css("visibility","");n(r).trigger("dadDrop",[t[0]])});this.dragging=!1;this.$current=null;this.$target=null;this.$clone=null;this.$placeholder=null}};t.prototype.getContainerX=function(){return this.$current.offset().left-this.$current.scrollLeft()};t.prototype.getContainerY=function(){return this.$current.offset().top-this.$current.scrollTop()};t.prototype.updateClonePosition=function(){var n=this.mouse.positionX-this.getContainerX()-this.mouse.offsetX,t=this.mouse.positionY-this.getContainerY()-this.mouse.offsetY;this.$clone.css({top:t,left:n})};t.prototype.updatePlaceholder=function(t,i,r){var f=this.$current,u=this.$target,e=this.$clone,o=this.$placeholder;r?(i.append(u),i.append(e),i.append(o),this.$current=i,n(f).trigger("dadDragExchange",[f[0],i[0]])):(i.index()>u.index()?i.after(u):i.before(u),n(f).trigger("dadDragUpdate",[u[0]]));this.updatePlaceholderPosition()};t.prototype.updatePlaceholderPosition=function(){var t=this.options.placeholderTarget,n=t?this.$target.find(t):this.$target,i=n.offset().top-this.getContainerY(),r=n.offset().left-this.getContainerX(),u=n.outerHeight(),f=n.outerWidth();this.$placeholder.css({top:i,left:r,width:f,height:u})};t.prototype.onDrop=function(t){function r(){var t=n(this);t.attr("data-dad-active",!0)}var i=n(t);i.on("mouseenter touchenter",r)};t.prototype.setActive=function(n){this.active=n;this.$container.attr("data-dad-active",n)};t.prototype.activate=function(){this.setActive(!0)};t.prototype.deactivate=function(){this.setActive(!1)};n.fn.dad=function(n){return new t(this,n)}})(jQuery);
//# sourceMappingURL=jquery.dad.min.js.map